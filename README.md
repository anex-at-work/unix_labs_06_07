# Докеризация лабораторных работ (#6 и #7) для АВС Unix

## Общее описание

Представлено два docker-контейнера, находящихся в одной подсети. Один из серверов представляет собой dns-сервер на основе [dnsmasq](http://www.thekelleys.org.uk/dnsmasq/doc.html), второй - http-сервер на основе [nginx](https://nginx.org/en/) (использован официальный docker-контейнер https://hub.docker.com/_/nginx/).

На dns-сервере после полного запуска формируются корректные A-записи для http-контейнера, таким образом, при установке "извне" dns-сервером первого контейнера можно будет получать информацию со второго контейнера, и, при этом не важно, какой ip будет иметь http-контейнер.

## Порты

На dns-контейнере открыты порты 53/tcp и 53/udp на ip 127.0.0.1, таким образом, необходимо на host-машине установить дополнительный (или основным) dns-сервер 127.0.0.1.

На http-контейнере открыт порт 80 для получения данных по протоколу http

## Запуск через скрипт

Для запуска необходимо выполнить:

`./script.sh start`

, для остановки необходимо выполнить:

`./script.sh stop`

(**ВНИМАНИЕ**) Необходимо убедиться в достаточном наличии прав для запуска docker

## Запуск через docker-compose

Для запуска необходимо выполнить:

`docker-compose up -d && docker exec `docker-compose ps -q dns` bash -c "chmod o+x /root/dns_rewrite.sh && /root/dns_rewrite.sh"`

Для остановки необходимо выполнить:

`docker-compose down`

## Проверка

После запуска и при установленном dns-сервере 127.0.0.1 можно выполнить: `wget http://lxc02.z2442` (для примера имя http-сервера поставлено lxc02.z2442) - и получить страницу с содержанием `This is a simple html`